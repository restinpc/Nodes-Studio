// Nodes Studio 2.0.2 script. Do not edit directly. 28/01/2017
function addHandler(a,b,c,d){a.addEventListener?a.addEventListener(b,c,!!d&&d):a.attachEvent?a.attachEvent("on"+b,c):alert("Add handler is not supported")}function drag(a){if(!a)var a=window.event;a.pageX||a.pageY?(posx=a.pageX,posy=a.pageY):(a.clientX||a.clientY)&&(posx=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,posy=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);try{var b=a.changedTouches[0];posx=parseInt(b.clientX),posy=parseInt(b.clientY)}catch(a){}if(1==drag_mode)0==fx&&(fx=posx-parseInt(document.getElementById("frame").style.left)),0==fy&&(fy=posy-parseInt(document.getElementById("frame").style.top)),posx-=fx,posy-=fy,posx>document.getElementById("img").clientWidth-document.getElementById("frame").clientWidth+34&&(posx=document.getElementById("img").clientWidth-document.getElementById("frame").clientWidth+34),posy>document.getElementById("img").clientHeight-document.getElementById("frame").clientHeight+34&&(posy=document.getElementById("img").clientHeight-document.getElementById("frame").clientHeight+34),posy<34&&(posy=34),posx<34&&(posx=34),document.getElementById("frame").style.left=posx-6+"px",document.getElementById("frame").style.top=posy-6+"px",document.getElementById("t").value=posy-32,document.getElementById("l").value=posx-32;else if(2==drag_mode){var c=posx-parseInt(document.getElementById("frame").style.left);c+parseInt(document.getElementById("frame").style.left)>document.getElementById("img").clientWidth+24&&(c=document.getElementById("img").clientWidth-parseInt(document.getElementById("frame").style.left)+24);var d=c*(twidth/theight);c-26<=document.getElementById("img").clientWidth-parseInt(document.getElementById("frame").style.left)&&d-26<=document.getElementById("img").clientHeight-parseInt(document.getElementById("frame").style.top)&&d>=theight/2&&c>=twidth/2&&(width=c+4,height=d+4,document.getElementById("frame").style.width=width+"px",document.getElementById("frame").style.height=height+"px",document.getElementById("w").value=width,document.getElementById("h").value=height)}else fx=0,fy=0}function submit_img(){confirm(confirm_upload)&&document.getElementById("form").submit()}function load(){document.getElementById("img").clientHeight<height?(height=document.getElementById("img").clientHeight,width=parseInt(twidth/theight*height)):document.getElementById("img").clientWidth<width&&(width=document.getElementById("img").clientWidth,height=parseInt(theight/twidth*width)),document.getElementById("frame").style.width=width,document.getElementById("frame").style.height=height,document.getElementById("frame").style.display="block"}function undrag(){drag_mode=0}function $id(a){return document.getElementById(a)}function FileDragHover(a){a.stopPropagation(),a.preventDefault(),a.target.className="dragover"==a.type?"hover":""}function FileSelectHandler(a){FileDragHover(a);for(var d,b=a.target.files||a.dataTransfer.files,c=0;d=b[c];c++)ParseFile(d)}function ParseFile(a){if(0==a.type.indexOf("image")){var b=new FileReader;b.onload=function(b){UploadFile(a)},b.readAsDataURL(a)}}function UploadFile(a){if(!(location.host.indexOf("sitepointstatic")>=0)&&""==$id("fileselect").value){var b=new XMLHttpRequest;if(b.upload&&("image/jpeg"==a.type||"image/jpg"==a.type||"image/gif"==a.type||"image/png"==a.type)&&a.size<=$id("MAX_FILE_SIZE").value){var c=a.name;b.onreadystatechange=function(a){4==b.readyState&&("error"==b.responseText?(document.getElementById("fileselect").style.display="block",document.getElementById("filedrag").style.display="none",alert(no_drag_drop)):(document.getElementById("new_image").value=c,document.getElementById("new_image_form").submit()))},b.open("POST",dir+"/uploader.php?dragndrop=1",!0),b.setRequestHeader("X_FILENAME",a.name),b.setRequestHeader("HTTP_X_FILENAME",a.name),b.send(a),document.getElementById("filedrag").innerHTML=uploading+".."}}}function Init(){var a=$id("fileselect"),b=$id("filedrag"),c=$id("submitbutton");a.addEventListener("change",FileSelectHandler,!1);var d=new XMLHttpRequest;d.upload&&(b.addEventListener("dragover",FileDragHover,!1),b.addEventListener("dragleave",FileDragHover,!1),b.addEventListener("drop",FileSelectHandler,!1),b.style.display="block",c.style.display="none")}post_new_image&&(addHandler(window,"load",load),addHandler(window,"touchmove",drag),addHandler(window,"mousemove",drag),addHandler(window,"mouseup",undrag),addHandler(top,"mouseup",undrag),addHandler(window,"dblclick",submit_img));